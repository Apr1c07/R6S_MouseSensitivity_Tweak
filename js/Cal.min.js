var dpi,x,y,ads,ads_mag,DPI_HIP,msmu,xfa,DPI_ADS,dpi_val_min,ItemList=new Array;function Cal(){dpi=Number(document.getElementById("DPI").value),x=Number(document.getElementById("x").value),y=Number(document.getElementById("y").value),ads=Number(document.getElementById("ADS").value),msmu=Number(document.getElementById("MSMU").value),xfa=Number(document.getElementById("XFA").value);var e=document.getElementById("ResTable"),n=document.getElementById("UserSettingTable");if(1!=e.rows.length)for(;e.rows[1];)e.deleteRow(1);if(1!=n.rows.length)for(;n.rows[1];)n.deleteRow(1);DPI_HIP=dpi*x*msmu,DPI_ADS=dpi*x*msmu*ads*xfa,(dpi_val_min=Math.trunc(DPI_HIP)-500)<=0&&(dpi_val_min=1);var t=n.insertRow(-1),i=t.insertCell(-1),r=t.insertCell(-1),a=t.insertCell(-1),l=t.insertCell(-1),m=t.insertCell(-1),s=t.insertCell(-1),d=t.insertCell(-1);i.innerHTML=dpi*x*msmu,r.innerHTML=dpi*y*msmu,a.innerHTML=x,l.innerHTML=y,m.innerHTML=ads,s.innerHTML=msmu.toFixed(6),d.innerHTML=xfa.toFixed(6);for(var u=dpi_val_min;u<=Math.trunc(DPI_HIP)+500;u++)if(msmu_dpi_check(u)&&ads_xfac_check(DPI_ADS/u)){let{msmu_new:n,x_new:t}=x_msmu_cal(u),{xfa_new:c,ads_new:f}=ads_xfac_cal(DPI_ADS/u);var _=y*(t/x);if(0===getDecimalPointLength(_)){var o=e.insertRow(-1);i=o.insertCell(-1),r=o.insertCell(-1),a=o.insertCell(-1),l=o.insertCell(-1),m=o.insertCell(-1),s=o.insertCell(-1),d=o.insertCell(-1);i.innerHTML=dpi*t*n,r.innerHTML=dpi*_*n,a.innerHTML=t,l.innerHTML=_,m.innerHTML=f,s.innerHTML=n.toFixed(6),d.innerHTML=c.toFixed(6)}}}function msmu_dpi_check(e){for(var n,t=!1,i=1;i<=100;i++)(n=e/dpi/i)>0&&getDecimalPointLength(n)<=6&&n<10&&(t=!0);return!!t}function ads_xfac_check(e){for(var n,t=!1,i=1;i<=100;i++)(n=e/i)>0&&getDecimalPointLength(n)<=6&&n<10&&(t=!0);return!!t}function x_msmu_cal(e){var n,t=1e4;let i=0,r=0;for(var a=1;a<=100;a++)(n=e/dpi/a)>0&&getDecimalPointLength(n)<=6&&n<10&&Math.abs(n-msmu)<t&&(t=Math.abs(n-msmu),i=n,r=a);return{msmu_new:i,x_new:r}}function ads_xfac_cal(e){var n,t=1e4;let i=0,r=0;for(var a=1;a<=100;a++)(n=e/a)>0&&getDecimalPointLength(n)<=6&&n<10&&Math.abs(n-xfa)<t&&(t=Math.abs(n-xfa),i=n,r=a);return{xfa_new:i,ads_new:r}}var getDecimalPointLength=function(e){var n=String(e).split("."),t=0;return n[1]&&(t=n[1].length),t};
